<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - OshEstate</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .admin-header { background: #1a2b3c; color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; }
        .admin-grid { display: grid; gap: 20px; margin-top: 20px; }
        .admin-card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; gap: 20px; align-items: center; }
        .admin-img { width: 120px; height: 90px; object-fit: cover; border-radius: 6px; }
        .admin-info { flex: 1; }
        .admin-actions { display: flex; flex-direction: column; gap: 8px; }
        .btn-approve { background: #27ae60; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-reject { background: #e74c3c; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .status-badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; margin-bottom: 5px; }
        .status-pending { background: #f39c12; color: white; }
        .status-active { background: #27ae60; color: white; }
    </style>
</head>
<body>

    <div id="adminLogin" class="container" style="height: 100vh; display: flex; align-items: center; justify-content: center;">
        <div class="card-style" style="max-width: 400px; text-align: center;">
            <h2>–ê–¥–º–∏–Ω –í—Ö–æ–¥</h2>
            <div class="form-group" style="margin-top: 20px;">
                <input type="password" id="adminPass" placeholder="–ü–∞—Ä–æ–ª—å (admin)">
            </div>
            <button class="btn-submit" id="btnAdminLogin">–í–æ–π—Ç–∏</button>
        </div>
    </div>

    <div id="adminPanel" style="display: none;">
        <div class="admin-header">
            <h2>–ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</h2>
            <button onclick="location.href='index.html'" style="background:none; border:1px solid rgba(255,255,255,0.3); color:white; padding:5px 15px; border-radius:4px; cursor:pointer;">–ù–∞ —Å–∞–π—Ç &rarr;</button>
        </div>

        <div class="container section">
            <h3 style="margin-bottom: 20px;">–°–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π (<span id="pendingCount">0</span> –Ω–æ–≤—ã—Ö)</h3>
            <div id="adminList" class="admin-grid"></div>
        </div>
    </div>

    <script type="module">
        document.addEventListener('DOMContentLoaded', () => {
            const loginBlock = document.getElementById('adminLogin');
            const panelBlock = document.getElementById('adminPanel');
            const btnLogin = document.getElementById('btnAdminLogin');
            const list = document.getElementById('adminList');
            const DB_KEY = 'oshEstate_v2'; // –í–ê–ñ–ù–û: –¢–æ—Ç –∂–µ –∫–ª—é—á, —á—Ç–æ –∏ –≤ script.js

            btnLogin.addEventListener('click', () => {
                if(document.getElementById('adminPass').value === 'admin') {
                    loginBlock.style.display = 'none';
                    panelBlock.style.display = 'block';
                    loadAdminAds();
                } else {
                    alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å');
                }
            });

            function loadAdminAds() {
                let ads = JSON.parse(localStorage.getItem(DB_KEY)) || [];
                list.innerHTML = '';
                
                let pending = 0;
                
                if(ads.length === 0) {
                    list.innerHTML = '<p style="text-align:center; padding:20px;">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞</p>';
                    return;
                }

                ads.forEach(ad => {
                    if(ad.status === 'pending') pending++;
                    const isPending = ad.status === 'pending';
                    
                    list.innerHTML += `
                        <div class="admin-card">
                            <img src="${ad.image}" class="admin-img" onerror="this.src='https://via.placeholder.com/150'">
                            <div class="admin-info">
                                <span class="status-badge ${isPending ? 'status-pending' : 'status-active'}">
                                    ${isPending ? '–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏' : '–ê–∫—Ç–∏–≤–Ω–æ'}
                                </span>
                                <h4>${new Intl.NumberFormat('ru-RU').format(ad.price)} —Å–æ–º</h4>
                                <p>${ad.address}</p>
                                <p style="font-size:0.85rem; color:#666;">${ad.author || '–ê–Ω–æ–Ω–∏–º'} | ${new Date(ad.date).toLocaleDateString()}</p>
                            </div>
                            <div class="admin-actions">
                                ${isPending ? `<button class="btn-approve" onclick="approveAd(${ad.id})">‚úÖ –û–¥–æ–±—Ä–∏—Ç—å</button>` : ''}
                                <button class="btn-reject" onclick="deleteAd(${ad.id})">üóë –£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                        </div>
                    `;
                });
                document.getElementById('pendingCount').innerText = pending;
            }

            window.approveAd = function(id) {
                let ads = JSON.parse(localStorage.getItem(DB_KEY));
                const idx = ads.findIndex(a => a.id === id);
                if(idx > -1) {
                    ads[idx].status = 'active';
                    localStorage.setItem(DB_KEY, JSON.stringify(ads));
                    loadAdminAds();
                }
            }

            window.deleteAd = function(id) {
                if(confirm('–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞?')) {
                    let ads = JSON.parse(localStorage.getItem(DB_KEY));
                    const newAds = ads.filter(a => a.id !== id);
                    localStorage.setItem(DB_KEY, JSON.stringify(newAds));
                    loadAdminAds();
                }
            }
        });
    </script>
</body>
</html>